<section class="custom-grid-section">
  <h2 class="grid-heading">Tisso visson in the wild</h2>
  <div class="grid-container">
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/black-bag-over-the-shoulder_925x_4cae5708-5e9e-4e7e-96ec-9649f0c20cd8.jpg?v=1755332427" alt="image1" width="920" height="944">
      <div class="hotspot" 
          style="top: 54%; left: 56%;" 
          data-title="Orange Wide Leg"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/black-bag-over-the-shoulder_925x_4cae5708-5e9e-4e7e-96ec-9649f0c20cd8.jpg?v=1755332427"
          data-colors='[{"name":"White","variant_id":1755332427},{"name":"Black","variant_id":1755332427}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/man-adjusts-blue-tuxedo-bowtie_925x_55a49e12-d54b-488e-b7a0-ea4c201eb01f.jpg?v=1755332417" alt="image2" width="920" height="944">
      <div class="hotspot" 
          style="top: 50%; left: 71%;" 
          data-title="Tailored Jecket"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/man-adjusts-blue-tuxedo-bowtie_925x_55a49e12-d54b-488e-b7a0-ea4c201eb01f.jpg?v=1755332417"
          data-colors='[{"name":"Blue","variant_id":1755332417},{"name":"Black","variant_id":1755332417}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/red-plaid-shirt_925x_70e9e5a8-8fc5-4d60-9a9a-cc2e0dd57cc9.jpg?v=1755332422" alt="image3" width="920" height="944">
      <div class="hotspot" 
          style="top: 18%; left: 56%;" 
          data-title="Accordion Pleated Dress"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/red-plaid-shirt_925x_70e9e5a8-8fc5-4d60-9a9a-cc2e0dd57cc9.jpg?v=1755332422"
          data-colors='[{"name":"Red","variant_id":1755332422},{"name":"Black","variant_id":1755332422}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/leather-jacket-and-tea_925x_2490cde1-7e61-4151-9a65-de8a763bc701.jpg?v=1755332433" alt="image4" width="920" height="944">
      <div class="hotspot" 
          style="top: 22%; left: 62%;" 
          data-title="Green Trench Coat"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/leather-jacket-and-tea_925x_2490cde1-7e61-4151-9a65-de8a763bc701.jpg?v=1755332433"
          data-colors='[{"name":"White","variant_id":1755332433},{"name":"Black","variant_id":1755332433}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/casual-fashion-woman_925x_56b56608-f207-45c1-b677-bb5aa26c1c7a.jpg?v=1755332440" alt="image5" width="920" height="944">
      <div class="hotspot" 
          style="top: 25%; left: 46%;" 
          data-title="Tennis Blue T-Shirt"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/casual-fashion-woman_925x_56b56608-f207-45c1-b677-bb5aa26c1c7a.jpg?v=1755332440"
          data-colors='[{"name":"Grey","variant_id":1755332440},{"name":"Black","variant_id":1755332440}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
    <div class= "image-hotspot-container">
      <img src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/young-female-models-denim_925x_44c2cf9e-4030-4347-9d4a-f0e4a1479b4a.jpg?v=1755332432" alt="image6" width="920" height="944">
      <div class="hotspot" 
          style="top: 40%; left: 64%;" 
          data-title="Long Sleeve Tennis Top"
          data-price="980,00€"
          data-desc="This one-piece swimsuit is crafted from jersey featuring an allover micro Monogram motif in relief."
          data-img="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/young-female-models-denim_925x_44c2cf9e-4030-4347-9d4a-f0e4a1479b4a.jpg?v=1755332432"
          data-colors='[{"name":"Blue","variant_id":1755332432},{"name":"Black","variant_id":1755332432}]'
          data-sizes='["S","M","L","XL"]'>
        +
      </div>
    </div>
  </div>
</section>

<!-- Popup -->

<div id="product-popup" class="popup">
  <div class="popup-content">
    <span class="close">&times;</span>
    
    <div class="popup-top">
      <img id="popup-image" src="https://cdn.shopify.com/s/files/1/0774/3238/9876/files/young-female-models-denim_925x_44c2cf9e-4030-4347-9d4a-f0e4a1479b4a.jpg?v=1755332432" alt="" width="120" height="140">
    <div class="popup-details">
        <h3 id="popup-title"></h3>
        <p id="popup-price"></p>
        <p id="popup-desc"></p>
      </div>
    </div>

    <div class="popup-options">
      <label>Color</label>
      <div id="popup-colors" class="popup-colors"></div>

      <label>Size</label>
      <select id="popup-size"></select>
    </div>

    <button id="popup-add-to-cart" class="add-to-cart-btn">ADD TO CART →</button>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const hotspots = document.querySelectorAll(".hotspot");
  const popup = document.getElementById("product-popup");
  const closeBtn = popup.querySelector(".close");

  const popupImage = document.getElementById("popup-image");
  const popupTitle = document.getElementById("popup-title");
  const popupPrice = document.getElementById("popup-price");
  const popupDesc = document.getElementById("popup-desc");
  const popupColors = document.getElementById("popup-colors");
  const popupSize = document.getElementById("popup-size");
  const addToCartBtn = document.getElementById("popup-add-to-cart");

  let selectedVariantId = null;

  hotspots.forEach(hotspot => {
    hotspot.addEventListener("click", function() {
      popupImage.src = this.getAttribute("data-img");
      popupTitle.textContent = this.getAttribute("data-title");
      popupPrice.textContent = this.getAttribute("data-price");
      popupDesc.textContent = this.getAttribute("data-desc");

      // Colors
      popupColors.innerHTML = "";
      const colors = JSON.parse(this.getAttribute("data-colors"));
      colors.forEach(c => {
        const btn = document.createElement("button");
        btn.textContent = c.name;
        btn.addEventListener("click", () => {
          popupColors.querySelectorAll("button").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          selectedVariantId = c.variant_id; // store correct variant
        });
        popupColors.appendChild(btn);
      });

      // Sizes (optional, if sizes are separate variants you’d handle same way)
      popupSize.innerHTML = "<option>Choose your size</option>";
      const sizes = JSON.parse(this.getAttribute("data-sizes"));
      sizes.forEach(size => {
        const option = document.createElement("option");
        option.value = size;
        option.textContent = size;
        popupSize.appendChild(option);
      });

      popup.style.display = "flex";
    });
  });

  // Add to cart button
  addToCartBtn.addEventListener("click", function() {
    if (!selectedVariantId) {
      alert("Please select a color/variant first!");
      return;
    }

    fetch('/cart/add.js', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        id: selectedVariantId,
        quantity: 1
      })
    })
    .then(res => res.json())
    .then(data => {
      alert("✅ Added to cart!");
      popup.style.display = "none";
    })
    .catch(err => {
      console.error(err);
      alert("❌ Failed to add to cart");
    });
  });

  // Close popup
  closeBtn.addEventListener("click", () => popup.style.display = "none");
  window.addEventListener("click", e => {
    if (e.target === popup) popup.style.display = "none";
  });
});

</script>

{% schema %}
{
  "name": "Grid Section",
  "blocks": [
    {
      "type": "grid_item",
      "name": "Grid Item",
      "settings": [
        {
          "type": "text",
          "id": "caption",
          "label": "Caption"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Grid Section",
      "category": "Custom"
    }
  ]
}
{% endschema %}
